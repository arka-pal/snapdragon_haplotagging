curr.dir <- "/Volumes/home/Project-ClineFitting/newrun03082021"
#Snail---------
snail <- list.files(paste(curr.dir,"snail-sim",sep="/"), full.names = T)
sim_snail
snail[1]
load(snail[1])
snail_sim
snail
setwd("/Volumes/apal/from_mac_202111123_desktop/TrimbleDataCleaning-2021/sample_identification_for_FWF")
library(plotly)
library(plotly)
library(ggplot2)
fwf <- read.csv("merged_haplotag.csv", header = T, na.strings = T, strip.white = T)
str(fwf)
p <- ggplot(fwf) +
geom_point(aes(AvgLong, AvgLat))
p
ggplotly(p)
p <- ggplot(fwf) +
geom_point(aes(AvgLong, AvgLat, label=ID))
p <- ggplot(fwf, aes(label=ID)) +
geom_point(aes(AvgLong, AvgLat))
ggplotly(p)
p <- ggplot(fwf, aes(label=c(ID, Red, Yellow)) +
geom_point(aes(AvgLong, AvgLat))
p <- ggplot(fwf, aes(label=c(ID, Red, Yellow)) +
p <- ggplot(fwf, aes(label=c(ID, Red, Yellow)) +
geom_point(aes(AvgLong, AvgLat))
))))
p <- ggplot(fwf, aes(label=c(ID, Red, Yellow)) + geom_point(aes(AvgLong, AvgLat))
p <- ggplot(fwf, aes(label=c(ID, Red, Yellow))) + geom_point(aes(AvgLong, AvgLat))
p <- ggplot(fwf, aes(label=c(ID, Red, Yellow))) + geom_point(aes(AvgLong, AvgLat))
ggplotly(p)
fwf <- read.csv("haplotag_samples_new.csv", header = T, na.strings = T, strip.white = T)
str(fwf)
fwf$c <- paste(fwf$ID,fwf$red,fwf$Yellow)
p <- ggplot(fwf, aes(label=c) + geom_point(aes(AvgLong, AvgLat))
p <- ggplot(fwf, aes(label=c)) + geom_point(aes(AvgLong, AvgLat))
p <- ggplot(fwf, aes(label=c)) + geom_point(aes(AvgLong, AvgLat))
ggplotly(p)
fwf$c <- paste(fwf$ID,'',fwf$Red,'',fwf$Yellow)
p <- ggplot(fwf, aes(label=c)) + geom_point(aes(AvgLong, AvgLat))
ggplotly(p)
fwf$c <- if (fwf$Red <= 0.5 && fwf$Yellow >= 2.5){"Yellow"}
fwf$c
fwf$Red <= 0.5 && fwf$Yellow >= 2.5
fwf$lab[2]
fwf$lab
fwf$lab <- paste(fwf$ID,'',fwf$Red,'',fwf$Yellow)
fwf$lab
fwf$lab[2]
for (i in c(1:nrow(fwf))){
fwf$c[i] <- if (fwf$Red <= 0.5 && fwf$Yellow > 2.5){"Yellow"}
elseif(fwf$Red > 3 && fwf$Yellow <= 1){"Magenta"}
elseif(fwf$Red >= 1.5 && fwf$Red <= 2.5 && fwf$Yellow <= 1){"Pink"}
elseif(fwf$Red > 2.5 && fwf$Yellow > 2){"Orange"}
elseif(fwf$Red <= 1 && fwf$Yellow <= 1){"lightgrey"}
else("Black")
}
for (i in c(1:nrow(fwf))){
fwf$c[i] <- if (fwf$Red <= 0.5 && fwf$Yellow > 2.5){"Yellow"}
else if(fwf$Red > 3 && fwf$Yellow <= 1){"Magenta"}
else if(fwf$Red >= 1.5 && fwf$Red <= 2.5 && fwf$Yellow <= 1){"Pink"}
else if(fwf$Red > 2.5 && fwf$Yellow > 2){"Orange"}
else if(fwf$Red <= 1 && fwf$Yellow <= 1){"lightgrey"}
else("Black")
}
fwf$c
View(fwf)
str(fwf)
fwf$Red <- as.numeric(fwf$Red)
fwf$Yellow <- as.numeric(fwf$Yellow)
str(fwf)
for (i in c(1:nrow(fwf))){
fwf$c[i] <- if (fwf$Red <= 0.5 && fwf$Yellow > 2.5){"Yellow"}
else if(fwf$Red > 3 && fwf$Yellow <= 1){"Magenta"}
else if(fwf$Red >= 1.5 && fwf$Red <= 2.5 && fwf$Yellow <= 1){"Pink"}
else if(fwf$Red > 2.5 && fwf$Yellow > 2){"Orange"}
else if(fwf$Red <= 1 && fwf$Yellow <= 1){"lightgrey"}
else("Black")
}
fwf$c
str(fwf)
fwf$Red == 0.5 && fwf$Yellow == 2.5
fwf$Red <= 0.5 && fwf$Yellow >= 2.5
i=1
fwf$c[i] <- if (fwf$Red[i] <= 0.5 && fwf$Yellow[i] >= 2.5){"Yellow"}
fwf$c
for (i in c(1:nrow(fwf))){
fwf$c[i] <- if (fwf$Red[i] <= 0.5 && fwf$Yellow[i] >= 2.5){"Yellow"}
else if(fwf$Red[i] > 3 && fwf$Yellow[i] <= 1){"Magenta"}
else if(fwf$Red[i] >= 1.5 && fwf$Red[i] <= 2.5 && fwf$Yellow[i] <= 1){"Pink"}
else if(fwf$Red[i] > 2.5 && fwf$Yellow[i] > 2){"Orange"}
else if(fwf$Red[i] <= 1 && fwf$Yellow[i] <= 1){"lightgrey"}
else("Black")
}
for (i in c(1:nrow(fwf))){
fwf$c[i] <- if (fwf$Red[i] <= 0.5 && fwf$Yellow[i] >= 2.5){"Yellow"}
else if(fwf$Red[i] > 3 && fwf$Yellow[i] <= 1){"Magenta"}
else if(fwf$Red[i] >= 1.5 && fwf$Red[i] <= 2.5 && fwf$Yellow[i] <= 1){"Pink"}
else if(fwf$Red[i] > 2.5 && fwf$Yellow[i] > 2){"Orange"}
else if(fwf$Red[i] <= 1 && fwf$Yellow[i] <= 1){"lightgrey"}
else("Black")
}
for (i in c(1:nrow(fwf))){
fwf$c[i] <- if (fwf$Red[i] <= 0.5 && fwf$Yellow[i] >= 2.5){"Yellow"}
else if(fwf$Red[i] > 3 && fwf$Yellow[i] <= 1){"Magenta"}
else if(fwf$Red[i] >= 1.5 && fwf$Red[i] <= 2.5 && fwf$Yellow[i] <= 1){"Pink"}
else if(fwf$Red[i] > 2.5 && fwf$Yellow[i] > 2){"Orange"}
else if(fwf$Red[i] <= 1 && fwf$Yellow[i] <= 1){"lightgrey"}
else{"Black"}
}
for (i in c(1:nrow(fwf))){
fwf$c[i] <- if (fwf$Red[i] <= 0.5 && fwf$Yellow[i] >= 2.5){"Yellow"}
else if(fwf$Red[i] > 3 && fwf$Yellow[i] <= 1){"Magenta"}
else if(fwf$Red[i] >= 1.5 && fwf$Red[i] <= 2.5 && fwf$Yellow[i] <= 1){"Pink"}
else if(fwf$Red[i] > 2.5 && fwf$Yellow[i] > 2){"Orange"}
else if(fwf$Red[i] <= 1 && fwf$Yellow[i] <= 1){"lightgrey"}
else{"Black"}
}
fwf$Red[321]
fwf$Red[321] <- 100
fwf$Yellow[321]
fwf$Yellow[321] <- 100
fwf$lab <- paste(fwf$ID,'',fwf$Red,'',fwf$Yellow)
fwf$Red <- as.numeric(fwf$Red)
fwf$Red <- as.numeric(fwf$Red)
fwf$Red <- as.numeric(fwf$Red)
for (i in c(1:nrow(fwf))){
fwf$c[i] <- if (fwf$Red[i] <= 0.5 && fwf$Yellow[i] >= 2.5){"Yellow"}
else if(fwf$Red[i] > 3 && fwf$Yellow[i] <= 1){"Magenta"}
else if(fwf$Red[i] >= 1.5 && fwf$Red[i] <= 2.5 && fwf$Yellow[i] <= 1){"Pink"}
else if(fwf$Red[i] > 2.5 && fwf$Yellow[i] > 2){"Orange"}
else if(fwf$Red[i] <= 1 && fwf$Yellow[i] <= 1){"lightgrey"}
else{"Black"}
}
p <- ggplot(fwf, aes(label=lab)) + geom_point(colour=fwf$c,aes(AvgLong, AvgLat))
ggplotly(p)
ggplotly(p)
ggplotly(p)
for (i in c(1:nrow(fwf))){
fwf$c[i] <- if (fwf$Red[i] <= 0.5 && fwf$Yellow[i] >= 2.5){"Yellow"}
else if(fwf$Red[i] > 3 && fwf$Yellow[i] <= 1){"Magenta"}
else if(fwf$Red[i] >= 1.5 && fwf$Red[i] <= 2.5 && fwf$Yellow[i] <= 2){"Pink"}
else if(fwf$Red[i] > 2.5 && fwf$Yellow[i] > 2){"Orange"}
else if(fwf$Red[i] <= 1 && fwf$Yellow[i] <= 1){"lightgrey"}
else{"Black"}
}
p <- ggplot(fwf, aes(label=lab)) + geom_point(colour=fwf$c,aes(AvgLong, AvgLat))
ggplotly(p)
for (i in c(1:nrow(fwf))){
fwf$c[i] <- if (fwf$Red[i] <= 0.5 && fwf$Yellow[i] >= 2.5){"Yellow"}
else if(fwf$Red[i] > 3 && fwf$Yellow[i] <= 1){"Magenta"}
else if(fwf$Red[i] >= 1.5 && fwf$Red[i] <= 2.5 && fwf$Yellow[i] <= 1){"Pink"}
else if(fwf$Red[i] > 2.5 && fwf$Yellow[i] > 2){"Orange"}
else if(fwf$Red[i] <= 1 && fwf$Yellow[i] <= 1){"lightgrey"}
else{"Black"}
}
p <- ggplot(fwf, aes(label=lab)) + geom_point(colour=fwf$c,aes(AvgLong, AvgLat))
ggplotly(p)
